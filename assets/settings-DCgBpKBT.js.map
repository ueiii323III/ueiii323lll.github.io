{"version":3,"file":"settings-DCgBpKBT.js","sources":["../../src/stores/settings.ts"],"sourcesContent":["import { defineStore } from 'pinia'\r\nimport { ref, computed } from 'vue'\r\nimport type { SiteSettings, CampusImage, Statistics, FeaturedWork } from '@/types/admin'\r\n\r\nexport const useSettingsStore = defineStore('settings', () => {\r\n  // 状态\r\n  const siteSettings = ref<SiteSettings>({\r\n    siteTitle: '孙可馨的个人空间',\r\n    siteDescription: '专注于绘画与摄影创作，记录生活点滴，分享艺术之美。',\r\n    authorName: '孙可馨',\r\n    authorEmail: 'contact@sun-kexin.com',\r\n    authorBio: '热爱艺术创作的大学生，专注于摄影与绘画，通过镜头和画笔记录生活的美好瞬间。',\r\n    profileImage: '/src/assets/images/avatar/profile.jpg',\r\n    heroImage: '/src/assets/images/avatar/hero.jpg',\r\n    socialLinks: {\r\n      github: 'https://github.com/sun-kexin',\r\n      email: 'contact@sun-kexin.com',\r\n      wechat: '',\r\n      qq: ''\r\n    },\r\n    seo: {\r\n      keywords: ['孙可馨', '个人网站', '摄影', '绘画', '数字艺术', '武汉理工大学'],\r\n      description: '孙可馨的个人空间 - 专注于绘画与摄影创作，记录生活点滴，分享艺术之美。'\r\n    }\r\n  })\r\n  \r\n  const campusImages = ref<CampusImage[]>([\r\n    {\r\n      id: '1',\r\n      title: '艺术中心',\r\n      description: '校园艺术中心，是艺术创作和文化交流的重要场所。',\r\n      image: '/src/assets/images/campus/art-center.jpg',\r\n      order: 1,\r\n      createdAt: new Date().toISOString(),\r\n      updatedAt: new Date().toISOString()\r\n    },\r\n    {\r\n      id: '2',\r\n      title: '教学楼',\r\n      description: '主要教学楼，见证着无数学生的学习时光。',\r\n      image: '/src/assets/images/campus/teaching-building.jpg',\r\n      order: 2,\r\n      createdAt: new Date().toISOString(),\r\n      updatedAt: new Date().toISOString()\r\n    }\r\n  ])\r\n  \r\n  // 首页精选作品\r\n  const featuredWorks = ref<FeaturedWork[]>([\r\n    {\r\n      id: '3',\r\n      title: '青春记忆',\r\n      description: '水彩画作品，记录大学生活点滴',\r\n      category: 'painting',\r\n      order: 2,\r\n      createdAt: new Date().toISOString(),\r\n      updatedAt: new Date().toISOString()\r\n    },\r\n    {\r\n      id: '1',\r\n      title: '夕阳下的校园',\r\n      description: '武汉理工大学夕阳美景摄影作品',\r\n      category: 'photography',\r\n      order: 1,\r\n      createdAt: new Date().toISOString(),\r\n      updatedAt: new Date().toISOString()\r\n    },\r\n    {\r\n      id: '8',\r\n      title: '城市印象1',\r\n      description: '内蒙古自治区呼和浩特市城市风光摄影作品，展现青城的壮美风光与民族文化特色',\r\n      category: 'cityscape',\r\n      order: 3,\r\n      createdAt: new Date().toISOString(),\r\n      updatedAt: new Date().toISOString()\r\n    }\r\n  ])\r\n  \r\n  const isLoading = ref(false)\r\n  \r\n  // 计算属性\r\n  const statistics = computed((): Statistics => {\r\n    return {\r\n      totalWorks: 0, // 这个值需要从 works store 获取\r\n      totalImages: campusImages.value.length,\r\n      totalCategories: 4,\r\n      publishedWorks: 0, // 这个值需要从 works store 获取\r\n      lastUpdated: new Date().toISOString()\r\n    }\r\n  })\r\n  \r\n  // 初始化设置\r\n  const initSettings = () => {\r\n    const savedSettings = localStorage.getItem('site_settings')\r\n    if (savedSettings) {\r\n      siteSettings.value = JSON.parse(savedSettings)\r\n    }\r\n    \r\n    const savedCampusImages = localStorage.getItem('campus_images')\r\n    if (savedCampusImages) {\r\n      campusImages.value = JSON.parse(savedCampusImages)\r\n    }\r\n    \r\n    // 检查是否有旧的精选作品数据，如果有则清理\r\n    const savedFeaturedWorks = localStorage.getItem('featured_works')\r\n    if (savedFeaturedWorks) {\r\n      const oldFeaturedWorks = JSON.parse(savedFeaturedWorks)\r\n      // 检查是否有错误的ID匹配\r\n      const hasWrongIds = oldFeaturedWorks.some((fw: any) => {\r\n        if (fw.title === '青春记忆' && fw.id !== '3') return true\r\n        if (fw.title === '城市印象1' && fw.id !== '8') return true\r\n        if (fw.title === '夕阳下的校园' && fw.id !== '1') return true\r\n        return false\r\n      })\r\n      \r\n      if (hasWrongIds) {\r\n        clearOldFeaturedWorks()\r\n      } else {\r\n        featuredWorks.value = oldFeaturedWorks\r\n      }\r\n    }\r\n    \r\n    // 始终保存最新的精选作品数据\r\n    saveFeaturedWorks()\r\n  }\r\n  \r\n  // 保存设置到 localStorage\r\n  const saveSettings = () => {\r\n    localStorage.setItem('site_settings', JSON.stringify(siteSettings.value))\r\n  }\r\n  \r\n  // 保存校园图片\r\n  const saveCampusImages = () => {\r\n    localStorage.setItem('campus_images', JSON.stringify(campusImages.value))\r\n  }\r\n  \r\n  // 保存精选作品\r\n  const saveFeaturedWorks = () => {\r\n    localStorage.setItem('featured_works', JSON.stringify(featuredWorks.value))\r\n  }\r\n  \r\n  // 更新网站设置\r\n  const updateSiteSettings = (updates: Partial<SiteSettings>) => {\r\n    siteSettings.value = { ...siteSettings.value, ...updates }\r\n    saveSettings()\r\n  }\r\n  \r\n  // 添加校园图片\r\n  const addCampusImage = (image: Omit<CampusImage, 'id' | 'createdAt' | 'updatedAt'>) => {\r\n    const newImage: CampusImage = {\r\n      ...image,\r\n      id: Date.now().toString(),\r\n      createdAt: new Date().toISOString(),\r\n      updatedAt: new Date().toISOString()\r\n    }\r\n    \r\n    campusImages.value.push(newImage)\r\n    saveCampusImages()\r\n    return newImage\r\n  }\r\n  \r\n  // 更新校园图片\r\n  const updateCampusImage = (id: string, updates: Partial<CampusImage>) => {\r\n    const index = campusImages.value.findIndex(img => img.id === id)\r\n    if (index !== -1) {\r\n      campusImages.value[index] = {\r\n        ...campusImages.value[index],\r\n        ...updates,\r\n        updatedAt: new Date().toISOString()\r\n      }\r\n      saveCampusImages()\r\n      return campusImages.value[index]\r\n    }\r\n    return null\r\n  }\r\n  \r\n  // 删除校园图片\r\n  const deleteCampusImage = (id: string) => {\r\n    const index = campusImages.value.findIndex(img => img.id === id)\r\n    if (index !== -1) {\r\n      campusImages.value.splice(index, 1)\r\n      saveCampusImages()\r\n      return true\r\n    }\r\n    return false\r\n  }\r\n  \r\n  // 重新排序校园图片\r\n  const reorderCampusImages = (newOrder: string[]) => {\r\n    newOrder.forEach((id, index) => {\r\n      const image = campusImages.value.find(img => img.id === id)\r\n      if (image) {\r\n        image.order = index + 1\r\n        image.updatedAt = new Date().toISOString()\r\n      }\r\n    })\r\n    saveCampusImages()\r\n  }\r\n  \r\n  // 更新社交链接\r\n  const updateSocialLinks = (links: typeof siteSettings.value.socialLinks) => {\r\n    siteSettings.value.socialLinks = links\r\n    saveSettings()\r\n  }\r\n  \r\n  // 更新SEO设置\r\n  const updateSeoSettings = (seo: typeof siteSettings.value.seo) => {\r\n    siteSettings.value.seo = seo\r\n    saveSettings()\r\n  }\r\n  \r\n  // 添加精选作品\r\n  const addFeaturedWork = (work: Omit<FeaturedWork, 'id' | 'createdAt' | 'updatedAt'>) => {\r\n    const newWork: FeaturedWork = {\r\n      ...work,\r\n      id: Date.now().toString(),\r\n      createdAt: new Date().toISOString(),\r\n      updatedAt: new Date().toISOString()\r\n    }\r\n    \r\n    featuredWorks.value.push(newWork)\r\n    saveFeaturedWorks()\r\n    return newWork\r\n  }\r\n  \r\n  // 更新精选作品\r\n  const updateFeaturedWork = (id: string, updates: Partial<FeaturedWork>) => {\r\n    const index = featuredWorks.value.findIndex(work => work.id === id)\r\n    if (index !== -1) {\r\n      featuredWorks.value[index] = {\r\n        ...featuredWorks.value[index],\r\n        ...updates,\r\n        updatedAt: new Date().toISOString()\r\n      }\r\n      saveFeaturedWorks()\r\n      return featuredWorks.value[index]\r\n    }\r\n    return null\r\n  }\r\n  \r\n  // 删除精选作品\r\n  const deleteFeaturedWork = (id: string) => {\r\n    const index = featuredWorks.value.findIndex(work => work.id === id)\r\n    if (index !== -1) {\r\n      featuredWorks.value.splice(index, 1)\r\n      saveFeaturedWorks()\r\n      return true\r\n    }\r\n    return false\r\n  }\r\n  \r\n  // 重新排序精选作品\r\n  const reorderFeaturedWorks = (newOrder: string[]) => {\r\n    newOrder.forEach((id, index) => {\r\n      const work = featuredWorks.value.find(w => w.id === id)\r\n      if (work) {\r\n        work.order = index + 1\r\n        work.updatedAt = new Date().toISOString()\r\n      }\r\n    })\r\n    saveFeaturedWorks()\r\n  }\r\n  \r\n  // 清理旧的精选作品数据\r\n  const clearOldFeaturedWorks = () => {\r\n    localStorage.removeItem('featured_works')\r\n    saveFeaturedWorks() // 保存新的正确数据\r\n  }\r\n\r\n  return {\r\n    // 状态\r\n    siteSettings,\r\n    campusImages,\r\n    featuredWorks,\r\n    isLoading,\r\n    \r\n    // 计算属性\r\n    statistics,\r\n    \r\n    // 方法\r\n    initSettings,\r\n    updateSiteSettings,\r\n    addCampusImage,\r\n    updateCampusImage,\r\n    deleteCampusImage,\r\n    reorderCampusImages,\r\n    updateSocialLinks,\r\n    updateSeoSettings,\r\n    addFeaturedWork,\r\n    updateFeaturedWork,\r\n    deleteFeaturedWork,\r\n    reorderFeaturedWorks,\r\n    clearOldFeaturedWorks\r\n  }\r\n})"],"names":["useSettingsStore","defineStore","siteSettings","ref","campusImages","featuredWorks","isLoading","statistics","computed","initSettings","savedSettings","savedCampusImages","savedFeaturedWorks","oldFeaturedWorks","fw","clearOldFeaturedWorks","saveFeaturedWorks","saveSettings","saveCampusImages","updateSiteSettings","updates","addCampusImage","image","newImage","updateCampusImage","id","index","img","deleteCampusImage","reorderCampusImages","newOrder","updateSocialLinks","links","updateSeoSettings","seo","addFeaturedWork","work","newWork","updateFeaturedWork","deleteFeaturedWork","reorderFeaturedWorks","w"],"mappings":"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"}