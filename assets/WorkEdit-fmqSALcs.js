import{j as S,r as k,c as W,N as q,o as E,A as N,D as i,M as b,k as t,G as o,I as l,L as c,O as j,J as z}from"./vendor-Ci7_s8hB.js";import{u as D}from"./works-jBBbHn6Y.js";import{M as p}from"./tdesign-wfUGn-Om.js";import{_ as A}from"./index-Dfbevo4_.js";const G={class:"work-edit"},J={class:"page-header"},L={class:"header-actions"},O={class:"edit-container"},T={class:"form-actions"},F=S({__name:"WorkEdit",setup(H){const h=j(),_=q(),f=D(),g=k(!1),a=k({title:"",description:"",category:"photography",tags:[],thumbnail:"",fullImage:"",isPublished:!0,order:1}),w={title:[{required:!0,message:"请输入作品标题"}],description:[{required:!0,message:"请输入作品描述"}],category:[{required:!0,message:"请选择作品分类"}],thumbnail:[{required:!0,message:"请上传缩略图"}]},r=W(()=>_.name==="admin-work-edit");E(()=>{if(r.value){const d=_.params.id,e=f.works.find(n=>n.id===d);e&&(a.value={title:e.title,description:e.description,category:e.category,tags:[...e.tags],thumbnail:e.thumbnail||"",fullImage:e.fullImage||"",isPublished:e.isPublished,order:e.order})}});const y=async({validateResult:d,firstError:e})=>{if(!d){p.error(e.message);return}g.value=!0;try{if(r.value){const n=_.params.id;await f.updateWork(n,a.value),p.success("作品更新成功")}else await f.addWork(a.value),p.success("作品添加成功");h.push("/admin/works")}catch(n){console.error("提交失败:",n),p.error("操作失败，请重试")}finally{g.value=!1}},V=()=>{h.push("/admin/works")};return(d,e)=>{const n=l("t-icon"),v=l("t-button"),x=l("t-input"),u=l("t-form-item"),P=l("t-textarea"),m=l("t-option"),I=l("t-select"),U=l("t-tag-input"),B=l("t-upload"),C=l("t-switch"),M=l("t-form"),R=l("t-card");return z(),N("div",G,[i("div",J,[i("h2",null,b(r.value?"编辑作品":"添加作品"),1),i("div",L,[t(v,{onClick:V,variant:"outline"},{default:o(()=>[t(n,{name:"chevron-left"}),e[6]||(e[6]=c(" 返回 ",-1))]),_:1})])]),i("div",O,[t(R,null,{default:o(()=>[t(M,{data:a.value,rules:w,onSubmit:y},{default:o(()=>[t(u,{label:"作品标题",name:"title"},{default:o(()=>[t(x,{modelValue:a.value.title,"onUpdate:modelValue":e[0]||(e[0]=s=>a.value.title=s),placeholder:"请输入作品标题"},null,8,["modelValue"])]),_:1}),t(u,{label:"作品描述",name:"description"},{default:o(()=>[t(P,{modelValue:a.value.description,"onUpdate:modelValue":e[1]||(e[1]=s=>a.value.description=s),placeholder:"请输入作品描述",autosize:{minRows:4,maxRows:8}},null,8,["modelValue"])]),_:1}),t(u,{label:"作品分类",name:"category"},{default:o(()=>[t(I,{modelValue:a.value.category,"onUpdate:modelValue":e[2]||(e[2]=s=>a.value.category=s),placeholder:"请选择作品分类"},{default:o(()=>[t(m,{value:"photography",label:"摄影"}),t(m,{value:"painting",label:"绘画"}),t(m,{value:"digital",label:"数字艺术"}),t(m,{value:"cityscape",label:"城市印象"})]),_:1},8,["modelValue"])]),_:1}),t(u,{label:"标签",name:"tags"},{default:o(()=>[t(U,{modelValue:a.value.tags,"onUpdate:modelValue":e[3]||(e[3]=s=>a.value.tags=s),placeholder:"输入标签后按回车添加"},null,8,["modelValue"])]),_:1}),t(u,{label:"缩略图",name:"thumbnail"},{default:o(()=>[t(B,{modelValue:a.value.thumbnail,"onUpdate:modelValue":e[4]||(e[4]=s=>a.value.thumbnail=s),action:"/api/upload",theme:"file-input",accept:"image/*","max-size":5,tips:"支持 jpg、png 格式，文件大小不超过 5MB"},null,8,["modelValue"])]),_:1}),t(u,{label:"发布状态",name:"isPublished"},{default:o(()=>[t(C,{modelValue:a.value.isPublished,"onUpdate:modelValue":e[5]||(e[5]=s=>a.value.isPublished=s)},{label:o(()=>[c(b(a.value.isPublished?"已发布":"草稿"),1)]),_:1},8,["modelValue"])]),_:1}),i("div",T,[t(v,{theme:"primary",type:"submit",loading:g.value},{default:o(()=>[c(b(r.value?"更新作品":"添加作品"),1)]),_:1},8,["loading"]),t(v,{theme:"default",variant:"outline",onClick:V},{default:o(()=>[...e[7]||(e[7]=[c(" 取消 ",-1)])]),_:1})])]),_:1},8,["data"])]),_:1})])])}}}),Z=A(F,[["__scopeId","data-v-da97f0ed"]]);export{Z as default};
//# sourceMappingURL=WorkEdit-fmqSALcs.js.map
