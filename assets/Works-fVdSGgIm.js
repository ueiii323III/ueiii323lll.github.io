import{j as X,r as z,q as $,c as Y,o as Z,A as b,D as l,k as t,W as x,G as o,I as d,M as g,L as u,F as ee,H as te,K as ae,O as se,J as v}from"./vendor-Ci7_s8hB.js";import{u as oe}from"./works-jBBbHn6Y.js";import{M as f,D as le}from"./tdesign-wfUGn-Om.js";import{_ as ne}from"./index-Dfbevo4_.js";const ie={class:"works-management"},de={class:"page-header"},ce={class:"header-actions"},re={class:"filters"},ue={class:"filter-group"},me={class:"filter-group"},ge={class:"filter-group"},pe={class:"filter-group"},he={key:0,class:"batch-actions"},_e={class:"batch-info"},ve={class:"batch-buttons"},fe=["src","alt"],be={class:"title-cell"},ye={class:"tags-cell"},ke={key:0,class:"more-tags"},Ce={class:"action-buttons"},Ve={class:"pagination"},we=X({__name:"Works",setup(Pe){const k=se(),p=oe(),S=z(!1),c=z([]),n=$({search:"",category:"",published:""}),i=$({page:1,limit:10}),K=[{colKey:"select-row",type:"multiple-select",width:50},{colKey:"thumbnail",title:"缩略图",width:100},{colKey:"title",title:"作品信息",width:300},{colKey:"category",title:"分类",width:120},{colKey:"tags",title:"标签",width:200},{colKey:"status",title:"状态",width:100},{colKey:"updatedAt",title:"更新时间",width:150},{colKey:"action",title:"操作",width:200}],C=Y(()=>p.getPaginatedWorks({page:i.page,limit:i.limit,search:n.search||void 0,category:n.category||void 0,published:n.published!==""?n.published:void 0})),D=s=>({photography:"摄影",painting:"绘画",digital:"数字艺术",cityscape:"城市印象"})[s]||s,B=s=>({photography:"primary",painting:"success",digital:"warning",cityscape:"danger"})[s]||"default",N=s=>new Date(s).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),A=()=>{k.push("/admin/works/create")},E=()=>{i.page=1},V=()=>{i.page=1},F=()=>{n.search="",n.category="",n.published="",i.page=1},I=s=>{i.page=s},L=s=>{i.limit=s,i.page=1},M=s=>{c.value=s},U=s=>{window.open(`/portfolio/${s.id}`,"_blank")},T=s=>{k.push(`/admin/works/${s.id}/edit`)},j=s=>{p.updateWork(s.id,{isPublished:!s.isPublished}),f.success(`作品已${s.isPublished?"隐藏":"发布"}`)},q=s=>{p.deleteWork(s)?f.success("作品已删除"):f.error("删除失败")},w=s=>{p.updatePublishStatus(c.value,s),c.value=[],f.success(`已${s?"发布":"隐藏"}选中的作品`)},G=()=>{const s=le({header:"批量删除确认",body:`确定要删除选中的 ${c.value.length} 个作品吗？此操作不可恢复。`,confirmBtn:"确定删除",cancelBtn:"取消",onConfirm:()=>{c.value.forEach(a=>{p.deleteWork(a)}),c.value=[],f.success("批量删除成功"),s.destroy()}})},H=s=>{const a=s.target;a.src="/src/assets/images/avatar/placeholder.jpg"};return Z(()=>{p.initWorks()}),(s,a)=>{const h=d("t-icon"),r=d("t-button"),J=d("t-input"),m=d("t-option"),P=d("t-select"),W=d("t-card"),y=d("t-tag"),O=d("t-popconfirm"),R=d("t-table"),Q=d("t-pagination");return v(),b("div",ie,[l("div",de,[a[7]||(a[7]=l("div",{class:"header-content"},[l("h2",null,"作品管理"),l("p",null,"管理您的所有作品，包括摄影、绘画、数字艺术等")],-1)),l("div",ce,[t(r,{theme:"primary",onClick:A},{default:o(()=>[t(h,{name:"add"}),a[6]||(a[6]=u(" 添加作品 ",-1))]),_:1})])]),t(W,{class:"filters-card"},{default:o(()=>[l("div",re,[l("div",ue,[t(J,{modelValue:n.search,"onUpdate:modelValue":a[0]||(a[0]=e=>n.search=e),placeholder:"搜索作品...","prefix-icon":"search",onInput:E,clearable:""},null,8,["modelValue"])]),l("div",me,[t(P,{modelValue:n.category,"onUpdate:modelValue":a[1]||(a[1]=e=>n.category=e),placeholder:"选择分类",onChange:V,clearable:""},{default:o(()=>[t(m,{value:"",label:"全部分类"}),t(m,{value:"photography",label:"摄影"}),t(m,{value:"painting",label:"绘画"}),t(m,{value:"digital",label:"数字艺术"}),t(m,{value:"cityscape",label:"城市印象"})]),_:1},8,["modelValue"])]),l("div",ge,[t(P,{modelValue:n.published,"onUpdate:modelValue":a[2]||(a[2]=e=>n.published=e),placeholder:"发布状态",onChange:V,clearable:""},{default:o(()=>[t(m,{value:"",label:"全部状态"}),t(m,{value:!0,label:"已发布"}),t(m,{value:!1,label:"未发布"})]),_:1},8,["modelValue"])]),l("div",pe,[t(r,{theme:"default",variant:"outline",onClick:F},{default:o(()=>[t(h,{name:"refresh"}),a[8]||(a[8]=u(" 重置 ",-1))]),_:1})])])]),_:1}),c.value.length>0?(v(),b("div",he,[l("div",_e," 已选择 "+g(c.value.length)+" 个作品 ",1),l("div",ve,[t(r,{theme:"success",onClick:a[3]||(a[3]=e=>w(!0))},{default:o(()=>[...a[9]||(a[9]=[u(" 批量发布 ",-1)])]),_:1}),t(r,{theme:"warning",onClick:a[4]||(a[4]=e=>w(!1))},{default:o(()=>[...a[10]||(a[10]=[u(" 批量隐藏 ",-1)])]),_:1}),t(r,{theme:"danger",onClick:G},{default:o(()=>[...a[11]||(a[11]=[u(" 批量删除 ",-1)])]),_:1})])])):x("",!0),t(W,{class:"works-table"},{default:o(()=>[t(R,{data:C.value.items,columns:K,loading:S.value,"selected-row-keys":c.value,onSelectChange:M,"row-key":"id"},{thumbnail:o(({row:e})=>[l("img",{src:e.thumbnail,alt:e.title,class:"thumbnail",onError:H},null,40,fe)]),title:o(({row:e})=>[l("div",be,[l("h4",null,g(e.title),1),l("p",null,g(e.description),1)])]),category:o(({row:e})=>[t(y,{theme:B(e.category)},{default:o(()=>[u(g(D(e.category)),1)]),_:2},1032,["theme"])]),tags:o(({row:e})=>[l("div",ye,[(v(!0),b(ee,null,te(e.tags.slice(0,3),_=>(v(),ae(y,{key:_,size:"small",theme:"default",variant:"light"},{default:o(()=>[u(g(_),1)]),_:2},1024))),128)),e.tags.length>3?(v(),b("span",ke," +"+g(e.tags.length-3),1)):x("",!0)])]),status:o(({row:e})=>[t(y,{theme:e.isPublished?"success":"warning"},{default:o(()=>[u(g(e.isPublished?"已发布":"未发布"),1)]),_:2},1032,["theme"])]),updatedAt:o(({row:e})=>[u(g(N(e.updatedAt)),1)]),action:o(({row:e})=>[l("div",Ce,[t(r,{theme:"default",variant:"text",size:"small",onClick:_=>U(e)},{default:o(()=>[t(h,{name:"browse"})]),_:1},8,["onClick"]),t(r,{theme:"default",variant:"text",size:"small",onClick:_=>T(e)},{default:o(()=>[t(h,{name:"edit"})]),_:1},8,["onClick"]),t(r,{theme:"default",variant:"text",size:"small",onClick:_=>j(e)},{default:o(()=>[t(h,{name:e.isPublished?"eye-close":"eye"},null,8,["name"])]),_:2},1032,["onClick"]),t(O,{content:"确定要删除这个作品吗？",onConfirm:_=>q(e.id)},{default:o(()=>[t(r,{theme:"danger",variant:"text",size:"small"},{default:o(()=>[t(h,{name:"delete"})]),_:1})]),_:1},8,["onConfirm"])])]),_:1},8,["data","loading","selected-row-keys"]),l("div",Ve,[t(Q,{modelValue:i.page,"onUpdate:modelValue":a[5]||(a[5]=e=>i.page=e),total:C.value.total,"page-size":i.limit,onChange:I,"show-sizer":"",onPageSizeChange:L},null,8,["modelValue","total","page-size"])])]),_:1})])}}}),Se=ne(we,[["__scopeId","data-v-5a03c38a"]]);export{Se as default};
//# sourceMappingURL=Works-fVdSGgIm.js.map
