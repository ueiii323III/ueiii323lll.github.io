import{u as C}from"./settings-DCgBpKBT.js";import{M as k}from"./tdesign-wfUGn-Om.js";import{j as D,r as U,A as h,D as r,W as I,k as t,I as m,M as z,G as i,L as E,J as w,q as F,o as B}from"./vendor-Ci7_s8hB.js";import{_ as R}from"./index-Dfbevo4_.js";function T(s){return new Promise((c,u)=>{if(!s.type.startsWith("image/")){u(new Error("只能上传图片文件"));return}const e=10*1024*1024;if(s.size>e){u(new Error("图片文件大小不能超过10MB"));return}const p=new FileReader;p.onload=_=>{var y;try{const v=(y=_.target)==null?void 0:y.result;if(v.length>5*1024*1024){u(new Error("图片文件过大，请选择较小的图片"));return}c({url:v,filename:s.name,size:s.size,type:s.type})}catch{u(new Error("图片处理失败"))}},p.onerror=()=>{u(new Error("图片读取失败"))},p.readAsDataURL(s)})}function N(s){if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(s.type))return{valid:!1,error:"只支持 JPG、PNG、GIF、WebP 格式的图片"};const u=10*1024*1024;return s.size>u?{valid:!1,error:"图片文件大小不能超过10MB"}:{valid:!0}}const P={class:"image-upload-wrapper"},$=["src","alt"],q={key:1,class:"upload-content"},M={key:0,class:"upload-tip"},O={key:2,class:"upload-overlay"},G=["accept"],A={key:0,class:"image-actions"},Q=D({__name:"ImageUpload",props:{modelValue:{},alt:{default:""},accept:{default:"image/*"},uploadText:{default:"点击或拖拽上传图片"},tip:{default:""},iconSize:{default:"48px"},showActions:{type:Boolean,default:!0},maxSize:{default:10}},emits:["update:modelValue","success","fail"],setup(s,{emit:c}){const u=s,e=c,p=U(),_=U(!1),y=()=>{var l;(l=p.value)==null||l.click()},v=async l=>{const n=l.target.files;n&&n.length>0&&await b(n[0])},V=async l=>{var n;l.preventDefault(),l.stopPropagation();const d=(n=l.dataTransfer)==null?void 0:n.files;d&&d.length>0&&await b(d[0])},a=l=>{l.preventDefault(),l.stopPropagation()},b=async l=>{const d=N(l);if(!d.valid){k.error(d.error||"文件验证失败"),e("fail",new Error(d.error));return}_.value=!0;try{const n=await T(l);e("update:modelValue",n.url),e("success",n),k.success("图片上传成功")}catch(n){const g=n instanceof Error?n.message:"上传失败";k.error(g),e("fail",n instanceof Error?n:new Error(g))}finally{_.value=!1}},x=()=>{e("update:modelValue",""),p.value&&(p.value.value="")},f=()=>{u.modelValue&&window.open(u.modelValue,"_blank")};return(l,d)=>{const n=m("t-icon"),g=m("t-loading"),S=m("t-button");return w(),h("div",P,[r("div",{class:"upload-area",onClick:y,onDrop:V,onDragover:a},[s.modelValue?(w(),h("img",{key:0,src:s.modelValue,alt:s.alt,class:"preview-image"},null,8,$)):(w(),h("div",q,[t(n,{name:"upload",size:s.iconSize},null,8,["size"]),r("p",null,z(s.uploadText),1),s.tip?(w(),h("p",M,z(s.tip),1)):I("",!0)])),_.value?(w(),h("div",O,[t(g,{text:"上传中..."})])):I("",!0)],32),r("input",{ref_key:"fileInput",ref:p,type:"file",accept:s.accept,onChange:v,style:{display:"none"}},null,40,G),s.modelValue&&s.showActions?(w(),h("div",A,[t(S,{theme:"default",variant:"outline",size:"small",onClick:x},{default:i(()=>[t(n,{name:"delete"}),d[0]||(d[0]=E(" 删除 ",-1))]),_:1}),t(S,{theme:"default",variant:"text",size:"small",onClick:f},{default:i(()=>[t(n,{name:"browse"}),d[1]||(d[1]=E(" 预览 ",-1))]),_:1})])):I("",!0)])}}}),L=R(Q,[["__scopeId","data-v-ed6d8c70"]]),W={class:"settings-management"},H={class:"page-header"},J={class:"header-actions"},j={class:"settings-grid"},K={class:"avatar-settings"},X={class:"avatar-item"},Y={class:"avatar-upload"},Z=["src"],ee={class:"avatar-item"},te={class:"avatar-upload"},ae=["src"],le=D({__name:"Settings",setup(s){const c=C(),u=U(!1),e=F({siteTitle:"",siteDescription:"",authorName:"",authorEmail:"",authorBio:"",profileImage:"",heroImage:"",socialLinks:{github:"",email:"",wechat:"",qq:""},seo:{keywords:[],description:""}}),p=()=>{Object.assign(e,c.siteSettings)},_=V=>{console.log("头像上传成功:",V),k.success("头像上传成功")},y=V=>{console.log("封面上传成功:",V),k.success("封面上传成功")},v=async()=>{u.value=!0;try{c.updateSiteSettings(e),c.updateSocialLinks(e.socialLinks),c.updateSeoSettings(e.seo),k.success("设置保存成功")}catch{k.error("保存失败，请重试")}finally{u.value=!1}};return B(()=>{c.initSettings(),p()}),(V,a)=>{const b=m("t-icon"),x=m("t-button"),f=m("t-input"),l=m("t-form-item"),d=m("t-textarea"),n=m("t-form"),g=m("t-card"),S=m("t-tag-input");return w(),h("div",W,[r("div",H,[a[14]||(a[14]=r("div",{class:"header-content"},[r("h2",null,"网站设置"),r("p",null,"配置网站基本信息、SEO和社交链接")],-1)),r("div",J,[t(x,{theme:"primary",onClick:v,loading:u.value},{default:i(()=>[t(b,{name:"check"}),a[13]||(a[13]=E(" 保存设置 ",-1))]),_:1},8,["loading"])])]),r("div",j,[t(g,{title:"基本信息",class:"settings-card"},{default:i(()=>[t(n,{ref:"basicFormRef",data:e,"label-width":"100px"},{default:i(()=>[t(l,{label:"网站标题"},{default:i(()=>[t(f,{modelValue:e.siteTitle,"onUpdate:modelValue":a[0]||(a[0]=o=>e.siteTitle=o),placeholder:"请输入网站标题"},null,8,["modelValue"])]),_:1}),t(l,{label:"网站描述"},{default:i(()=>[t(d,{modelValue:e.siteDescription,"onUpdate:modelValue":a[1]||(a[1]=o=>e.siteDescription=o),placeholder:"请输入网站描述",autosize:{minRows:2,maxRows:4}},null,8,["modelValue"])]),_:1}),t(l,{label:"作者姓名"},{default:i(()=>[t(f,{modelValue:e.authorName,"onUpdate:modelValue":a[2]||(a[2]=o=>e.authorName=o),placeholder:"请输入作者姓名"},null,8,["modelValue"])]),_:1}),t(l,{label:"作者邮箱"},{default:i(()=>[t(f,{modelValue:e.authorEmail,"onUpdate:modelValue":a[3]||(a[3]=o=>e.authorEmail=o),placeholder:"请输入作者邮箱"},null,8,["modelValue"])]),_:1}),t(l,{label:"个人简介"},{default:i(()=>[t(d,{modelValue:e.authorBio,"onUpdate:modelValue":a[4]||(a[4]=o=>e.authorBio=o),placeholder:"请输入个人简介",autosize:{minRows:3,maxRows:6}},null,8,["modelValue"])]),_:1})]),_:1},8,["data"])]),_:1}),t(g,{title:"头像设置",class:"settings-card"},{default:i(()=>[r("div",K,[r("div",X,[a[15]||(a[15]=r("h4",null,"个人头像",-1)),r("div",Y,[r("img",{src:e.profileImage,alt:"个人头像",class:"avatar-preview"},null,8,Z),t(L,{modelValue:e.profileImage,"onUpdate:modelValue":a[5]||(a[5]=o=>e.profileImage=o),alt:"个人头像","upload-text":"更换头像","show-actions":!1,onSuccess:_},null,8,["modelValue"])])]),r("div",ee,[a[16]||(a[16]=r("h4",null,"封面图片",-1)),r("div",te,[r("img",{src:e.heroImage,alt:"封面图片",class:"hero-preview"},null,8,ae),t(L,{modelValue:e.heroImage,"onUpdate:modelValue":a[6]||(a[6]=o=>e.heroImage=o),alt:"封面图片","upload-text":"更换封面","show-actions":!1,onSuccess:y},null,8,["modelValue"])])])])]),_:1}),t(g,{title:"社交链接",class:"settings-card"},{default:i(()=>[t(n,{ref:"socialFormRef",data:e.socialLinks,"label-width":"80px"},{default:i(()=>[t(l,{label:"GitHub"},{default:i(()=>[t(f,{modelValue:e.socialLinks.github,"onUpdate:modelValue":a[7]||(a[7]=o=>e.socialLinks.github=o),placeholder:"https://github.com/username"},null,8,["modelValue"])]),_:1}),t(l,{label:"邮箱"},{default:i(()=>[t(f,{modelValue:e.socialLinks.email,"onUpdate:modelValue":a[8]||(a[8]=o=>e.socialLinks.email=o),placeholder:"contact@example.com"},null,8,["modelValue"])]),_:1}),t(l,{label:"微信"},{default:i(()=>[t(f,{modelValue:e.socialLinks.wechat,"onUpdate:modelValue":a[9]||(a[9]=o=>e.socialLinks.wechat=o),placeholder:"微信号或二维码链接"},null,8,["modelValue"])]),_:1}),t(l,{label:"QQ"},{default:i(()=>[t(f,{modelValue:e.socialLinks.qq,"onUpdate:modelValue":a[10]||(a[10]=o=>e.socialLinks.qq=o),placeholder:"QQ号码"},null,8,["modelValue"])]),_:1})]),_:1},8,["data"])]),_:1}),t(g,{title:"SEO设置",class:"settings-card"},{default:i(()=>[t(n,{ref:"seoFormRef",data:e.seo,"label-width":"80px"},{default:i(()=>[t(l,{label:"关键词"},{default:i(()=>[t(S,{modelValue:e.seo.keywords,"onUpdate:modelValue":a[11]||(a[11]=o=>e.seo.keywords=o),placeholder:"输入关键词后按回车添加"},null,8,["modelValue"])]),_:1}),t(l,{label:"SEO描述"},{default:i(()=>[t(d,{modelValue:e.seo.description,"onUpdate:modelValue":a[12]||(a[12]=o=>e.seo.description=o),placeholder:"请输入SEO描述",autosize:{minRows:2,maxRows:4}},null,8,["modelValue"])]),_:1})]),_:1},8,["data"])]),_:1})])])}}}),re=R(le,[["__scopeId","data-v-f48774a2"]]);export{re as default};
//# sourceMappingURL=Settings-Yqjg-lId.js.map
