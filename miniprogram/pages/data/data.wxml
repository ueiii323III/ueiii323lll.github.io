<!--data.wxml-->
<navigation-bar title="æ•°æ®ä¸­å¿ƒ" back="{{true}}" color="white" background="#FF91A4" bindback="handleBack"></navigation-bar>
<scroll-view class="scrollarea" scroll-y type="list">
  <view class="container">
    <!-- æœªç™»å½•æç¤º -->
    <view wx:if="{{!userProfile}}" class="no-data-section">
      <view class="no-data-icon">ğŸ“Š</view>
      <text class="no-data-text">è¯·å…ˆç™»å½•å¹¶å®Œå–„å¥åº·ä¿¡æ¯</text>
      <text class="no-data-desc">å®ŒæˆåŸºç¡€ä¿¡æ¯è®¾ç½®åå³å¯æŸ¥çœ‹æ•°æ®åˆ†æ</text>
      <button class="action-btn" bindtap="goToProfile">å»å®Œå–„ä¿¡æ¯</button>
    </view>
    
    <!-- å·²ç™»å½•æ˜¾ç¤ºå†…å®¹ -->
    <view wx:else>
      <!-- æ—¶é—´èŒƒå›´é€‰æ‹© -->
      <view class="time-range-section">
      <view class="range-tabs">
        <view class="range-item {{timeRange === 'today' ? 'active' : ''}}" 
              bindtap="onTimeRangeChange" 
              data-range="today">
          <text class="range-text">ä»Šæ—¥</text>
        </view>
        <view class="range-item {{timeRange === 'week' ? 'active' : ''}}" 
              bindtap="onTimeRangeChange" 
              data-range="week">
          <text class="range-text">æœ€è¿‘7å¤©</text>
        </view>
        <view class="range-item {{timeRange === 'month' ? 'active' : ''}}" 
              bindtap="onTimeRangeChange" 
              data-range="month">
          <text class="range-text">æœ€è¿‘30å¤©</text>
        </view>
      </view>
      <text class="date-range">{{timeRange === 'today' ? 'ä»Šæ—¥' : (startDate + ' - ' + endDate)}}</text>
    </view>

    <!-- ç»Ÿè®¡æ¦‚è§ˆ -->
    <view class="overview-section">
      <view class="overview-title">{{timeRange === 'today' ? 'ä»Šæ—¥' : (timeRange === 'week' ? 'æœ¬å‘¨' : 'æœ¬æœˆ')}}å¥åº·æ¦‚è§ˆ</view>
      
      <view class="stats-grid">
        <view class="stat-card water-card">
          <view class="stat-icon">ğŸ’§</view>
          <text class="stat-value">{{timeRange === 'today' ? todayStats.waterAmount : (timeRange === 'week' ? weeklyStats.totalWater : monthlyStats.totalWater)}}</text>
          <text class="stat-unit">ml</text>
          <text class="stat-label">æ€»é¥®æ°´é‡</text>
        </view>
        
        <view class="stat-card calorie-card">
          <view class="stat-icon">ğŸ”¥</view>
          <text class="stat-value">{{timeRange === 'today' ? todayStats.calorieIntake : (timeRange === 'week' ? weeklyStats.totalCalories : monthlyStats.totalCalories)}}</text>
          <text class="stat-unit">kcal</text>
          <text class="stat-label">æ€»çƒ­é‡æ‘„å…¥</text>
        </view>
        
        <view class="stat-card exercise-card">
          <view class="stat-icon">ğŸƒ</view>
          <text class="stat-value">{{timeRange === 'today' ? todayStats.exerciseDuration : (timeRange === 'week' ? weeklyStats.totalExercise : monthlyStats.totalExercise)}}</text>
          <text class="stat-unit">åˆ†é’Ÿ</text>
          <text class="stat-label">æ€»è¿åŠ¨æ—¶é•¿</text>
        </view>
        
        <view class="stat-card completion-card">
          <view class="stat-icon">âœ…</view>
          <text class="stat-value">{{timeRange === 'today' ? 'å®æ—¶' : (timeRange === 'week' ? weeklyCompletionRate : monthlyCompletionRate)}}%</text>
          <text class="stat-unit">å®Œæˆç‡</text>
          <text class="stat-label">{{timeRange === 'today' ? 'ä»Šæ—¥' : (timeRange === 'week' ? weeklyStats.completedDays : monthlyStats.completedDays)}}/{{timeRange === 'today' ? '3' : (timeRange === 'week' ? weeklyStats.totalDays : monthlyStats.totalDays)}}å¤©</text>
        </view>
      </view>
    </view>

    <!-- æ¯æ—¥æ•°æ®è¯¦æƒ… -->
    <view class="daily-data-section">
      <view class="section-title">æ¯æ—¥è¯¦æƒ…</view>
      
      <view class="daily-list">
        <view wx:for="{{dailyData}}" wx:key="date" class="daily-item {{item.completed ? 'completed' : ''}}">
          <view class="daily-date">
            <text class="date-text">{{item.date}}</text>
            <view wx:if="{{item.completed}}" class="completed-badge">âœ…</view>
          </view>
          
          <view class="daily-stats">
            <view class="mini-stat">
              <text class="mini-icon">ğŸ’§</text>
              <text class="mini-value">{{item.water}}</text>
            </view>
            <view class="mini-stat">
              <text class="mini-icon">ğŸ”¥</text>
              <text class="mini-value">{{item.calories}}</text>
            </view>
            <view class="mini-stat">
              <text class="mini-icon">ğŸƒ</text>
              <text class="mini-value">{{item.exercise}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- å¥åº·å»ºè®® -->
    <view wx:if="{{healthAdvices.length > 0}}" class="advice-section">
      <view class="section-title">å¥åº·å»ºè®®</view>
      
      <view class="advice-list">
        <view wx:for="{{healthAdvices}}" wx:key="id" class="advice-item">
          <view class="advice-header">
            <view class="advice-icon">ğŸ’¡</view>
            <text class="advice-title">{{item.title}}</text>
            <text class="advice-time">å‘¨æœŸæ€§å»ºè®®</text>
          </view>
          <text class="advice-content">{{item.content}}</text>
        </view>
      </view>
    </view>

    <!-- ç›®æ ‡å¯¹æ¯” -->
    <view wx:if="{{healthGoals}}" class="goals-section">
      <view class="section-title">ç›®æ ‡è¾¾æˆæƒ…å†µ</view>
      
      <view class="goals-comparison">
        <view class="goal-item">
          <view class="goal-info">
            <text class="goal-label">æ¯æ—¥é¥®æ°´ç›®æ ‡</text>
            <text class="goal-target">{{healthGoals.dailyWaterIntake}}ml</text>
          </view>
          <view class="goal-actual">
            <text class="actual-label">å¹³å‡å®é™…</text>
            <text class="actual-value">{{averageStats.avgWater}}ml</text>
          </view>
        </view>
        
        <view class="goal-item">
          <view class="goal-info">
            <text class="goal-label">æ¯æ—¥è¿åŠ¨ç›®æ ‡</text>
            <text class="goal-target">{{healthGoals.dailyExerciseDuration}}åˆ†é’Ÿ</text>
          </view>
          <view class="goal-actual">
            <text class="actual-label">å¹³å‡å®é™…</text>
            <text class="actual-value">{{averageStats.avgExercise}}åˆ†é’Ÿ</text>
          </view>
        </view>
        
        <view class="goal-item">
          <view class="goal-info">
            <text class="goal-label">æ¯æ—¥çƒ­é‡èŒƒå›´</text>
            <text class="goal-target">{{healthGoals.dailyCalorieMin}}-{{healthGoals.dailyCalorieMax}}kcal</text>
          </view>
          <view class="goal-actual">
            <text class="actual-label">å¹³å‡å®é™…</text>
            <text class="actual-value">{{averageStats.avgCalories}}kcal</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æ•°æ®æ“ä½œ -->
    <view class="actions-section">
      <view class="section-title">æ•°æ®ç®¡ç†</view>
      
      <view class="action-buttons">
        <button class="action-btn export-btn" bindtap="exportData">
          <text class="btn-icon">ğŸ“¤</text>
          <text class="btn-text">å¯¼å‡ºæ•°æ®</text>
        </button>
        
        <button class="action-btn share-btn" open-type="share">
          <text class="btn-icon">ğŸ“±</text>
          <text class="btn-text">åˆ†äº«æ•°æ®</text>
        </button>
      </view>
    </view>


      </view>
  </view>
</scroll-view>