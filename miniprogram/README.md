# 健康习惯打卡小程序

一个专注于个人健康习惯管理的微信小程序，帮助用户建立和维护良好的健康生活习惯。

## 功能特性

### 核心功能
- **饮水记录** - 追踪每日饮水量，达成饮水目标
- **饮食记录** - 记录每日饮食，计算热量摄入
- **运动记录** - 记录运动类型和时长，计算热量消耗
- **健康数据分析** - 多维度数据分析，提供健康建议
- **个人资料管理** - 管理身体指标，设置健康目标

### 特色功能
- **智能计算** - 自动计算BMI、目标体重、基础代谢率
- **健康建议** - 基于用户数据提供个性化健康建议
- **数据统计** - 今日/本周/本月数据统计，可视化展示
- **目标追踪** - 根据健康目标（减脂、增肌、维持健康）调整计划

## 技术栈

- **平台**：微信小程序
- **开发语言**：TypeScript
- **样式预处理**：Less
- **编译工具**：微信开发者工具
- **API版本**：2.32.3

## 项目结构

```
miniprogram-18/
├── miniprogram/                 # 小程序主目录
│   ├── pages/                   # 页面目录
│   │   ├── index/              # 首页
│   │   ├── profile/            # 个人中心
│   │   ├── water/              # 饮水记录
│   │   ├── food/               # 饮食记录
│   │   ├── exercise/           # 运动记录
│   │   ├── data/               # 数据中心
│   │   └── settings/           # 设置页面
│   ├── components/              # 组件目录
│   │   └── navigation-bar/     # 导航栏组件
│   ├── utils/                  # 工具类
│   │   ├── auth.ts            # 认证工具
│   │   ├── health-calculator.ts # 健康计算器
│   │   ├── storage.ts         # 存储工具
│   │   └── util.ts           # 通用工具
│   ├── images/                 # 图片资源
│   ├── app.js                 # 小程序入口
│   ├── app.json               # 小程序配置
│   └── app.less              # 全局样式
├── typings/                   # TypeScript类型定义
├── package.json               # 项目依赖
├── project.config.json        # 项目配置
└── tsconfig.json             # TypeScript配置
```

## 安装运行

### 环境要求
- 微信开发者工具
- Node.js (可选，用于npm包管理)

### 安装步骤

1. 克隆或下载项目到本地

2. 使用微信开发者工具打开项目根目录

3. 确保编译设置正确：
   - 使用 TypeScript
   - 使用 Less
   - ES6 转换开启

4. 点击编译运行

## 核心功能说明

### 1. 饮水记录 (water)
- 记录每次饮水量
- 追踪当日饮水量
- 显示饮水目标和完成进度
- 提供饮水提醒功能

### 2. 饮食记录 (food)
- 添加食物记录
- 自动计算食物热量
- 追踪每日热量摄入
- 对比热量目标范围

### 3. 运动记录 (exercise)
- 选择运动类型
- 设置运动时长和强度
- 自动计算热量消耗
- 统计运动总时长

### 4. 数据中心 (data)
- 时间范围切换（今日/7天/30天）
- 数据统计展示
- 每日数据详情
- 健康建议生成
- 目标达成情况分析

### 5. 个人中心 (profile)
- 微信登录/模拟登录
- 编辑基础健康信息
  - 身高、体重、性别、年龄
  - 活动量选择
  - 健康目标设置
  - 目标体重设定
- BMI 自动计算和分类
- 目标体重显示
- 健康目标展示
- 数据导出功能

## 健康计算说明

### BMI 计算
```
BMI = 体重(kg) / (身高(m) × 身高(m))
```

### BMI 分类标准
| BMI 范围 | 分类 |
|---------|------|
| < 18.5  | 偏瘦 |
| 18.5-23.9 | 正常 |
| 24.0-27.9 | 超重 |
| ≥ 28.0  | 肥胖 |

### 目标体重范围
根据健康目标设置不同的BMI范围：
- **减脂目标**：BMI 18.5-22.9
- **增肌目标**：BMI 20.0-24.0
- **维持健康**：BMI 18.5-23.9

### 基础代谢率 (BMR) 计算
**男性**：`BMR = 88.362 + (13.397 × 体重) + (4.799 × 身高) - (5.677 × 年龄)`

**女性**：`BMR = 447.593 + (9.247 × 体重) + (3.098 × 身高) - (4.330 × 年龄)`

### 每日总能量消耗 (TDEE)
`TDEE = BMR × 活动系数`

活动系数：
- 久坐少动：1.2
- 轻度活动：1.375
- 中度活动：1.55
- 高度活动：1.725

### 每日饮水目标
`每日饮水量 = 体重(kg) × 33ml`

### 热量调整
- **减脂目标**：TDEE - 300kcal
- **增肌目标**：TDEE + 300kcal
- **维持健康**：TDEE

## 数据存储

### 存储策略
- 使用微信小程序本地存储 `wx.setStorageSync` / `wx.getStorageSync`
- 主要存储键：
  - `userInfo` - 用户基本信息
  - `userProfile` - 用户健康资料
  - `healthGoals` - 健康目标
  - `records_YYYY-MM-DD` - 每日记录

### 数据结构

**用户资料**
```typescript
{
  height: number;           // 身高
  weight: number;           // 体重
  gender: 'male' | 'female';
  age: number;
  healthGoal: string;       // 健康目标
  activityLevel: string;    // 活动量
  bmi: number;             // BMI
  bmiCategory: string;     // BMI分类
  targetWeight: number;    // 目标体重
  createdAt: string;
  updatedAt: string;
}
```

**每日记录**
```typescript
{
  water: WaterRecord[];    // 饮水记录
  food: FoodRecord[];      // 饮食记录
  exercise: ExerciseRecord[]; // 运动记录
}
```

## 开发指南

### 代码规范
- 使用 TypeScript 进行类型检查
- 遵循 ESLint 代码规范
- 组件化开发，复用性强
- 统一的错误处理和日志记录

### 主要工具类说明

**StorageHelper** (`utils/storage.ts`)
- 提供统一的存储接口
- 封装微信本地存储API
- 支持数据导出和清理

**AuthHelper** (`utils/auth.ts`)
- 处理用户认证
- 管理用户资料和健康目标
- 提供数据验证和修复功能

**HealthCalculator** (`utils/health-calculator.ts`)
- BMICalculator：BMI计算和分类
- TargetWeightCalculator：目标体重计算
- HealthGoalsCalculator：健康目标生成
- FoodCalorieCalculator：食物热量计算
- ExerciseCalorieCalculator：运动热量计算
- HealthAdviceGenerator：健康建议生成

### 页面开发
- 每个页面包含 `.ts`、`.wxml`、`.less`、`.json` 文件
- 使用自定义导航栏组件
- 统一的页面布局和样式风格

## 常见问题

### Q: BMI 显示为 0 或 -- 怎么办？
A: 点击个人资料页面的"刷新"按钮，系统会重新计算BMI。

### Q: 目标体重范围不准确？
A: 检查是否正确设置了健康目标（减脂/增肌/维持健康）和活动量。

### Q: 数据丢失了怎么办？
A: 本项目使用本地存储，请定期使用"数据导出"功能备份重要数据。

### Q: 如何切换不同的时间范围？
A: 在数据中心页面，点击"今日"/"最近7天"/"最近30天"标签进行切换。

## 更新日志

### v1.0.0
- 初始版本发布
- 实现核心健康记录功能
- 支持数据统计和分析
- 提供健康建议生成

## 许可证

本项目仅供学习和参考使用。

## 联系方式

如有问题或建议，欢迎反馈。
